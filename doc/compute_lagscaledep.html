<HTML>
<HEAD>
   <TITLE> module compute_LagScaleDep (generated by f90doc) </TITLE>
</HEAD>
<H1> Module compute_LagScaleDep </H1>
<PRE>module compute_LagScaleDep

        ! Uses
    use <A HREF="parameters_io.html">parameters_IO</A>
    use <A HREF="decomp_2d.html">decomp_2d</A>
    use <A HREF="decomp_2d_custom.html">decomp_2d_custom</A>
    use <A HREF="testfilter.html">testfilter</A>
    use <A HREF="system_variables.html">system_variables</A>, only : u,v,w

        ! Variables
    type (DECOMP_INFO), private, save :: <A HREF="compute_lagscaledep.html#var_dcp">dcp</A>
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_tf1">tf1</A> = 2._rprec
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_tf1_2">tf1_2</A> = 4._rprec
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_tf2">tf2</A> = 4._rprec
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_tf2_2">tf2_2</A> = 16._rprec
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_opftime">opftime</A> = 1.5_rprec
    logical, private :: <A HREF="compute_lagscaledep.html#var_f_coeff_init">F_coeff_init</A> = .false.
    real (kind=rprec), public, allocatable, dimension(:,:,:) :: <A HREF="compute_lagscaledep.html#var_f_lm">F_LM</A>
    real (kind=rprec), public, allocatable, dimension(:,:,:) :: <A HREF="compute_lagscaledep.html#var_f_mm">F_MM</A>
    real (kind=rprec), public, allocatable, dimension(:,:,:) :: <A HREF="compute_lagscaledep.html#var_f_qn">F_QN</A>
    real (kind=rprec), public, allocatable, dimension(:,:,:) :: <A HREF="compute_lagscaledep.html#var_f_nn">F_NN</A>
    real (kind=rprec), public, allocatable, dimension(:,:,:) :: <A HREF="compute_lagscaledep.html#var_beta_mum">Beta_mum</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_u_lag">u_lag</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_v_lag">v_lag</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_w_lag">w_lag</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_s">S</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_s_bar">S_bar</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_s_hat">S_hat</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_u_bar">u_bar</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_v_bar">v_bar</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_w_bar">w_bar</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_u_hat">u_hat</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_v_hat">v_hat</A>
    real (kind=rprec), private, dimension(:,:,:), allocatable :: <A HREF="compute_lagscaledep.html#var_w_hat">w_hat</A>
    real (kind=rprec), private, parameter :: <A HREF="compute_lagscaledep.html#var_n_dmp">n_dmp</A> = 2._rprec

        ! Subroutines and functions
    public subroutine <A HREF="compute_lagscaledep.html#subroutine_lagscaledep_init">LagScaleDep_init</A> (dcp_main)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_lagscaledep_finalize">LagScaleDep_finalize</A> ()
    public subroutine <A HREF="compute_lagscaledep.html#subroutine_compute_lagscaledep_coeff">compute_LagScaleDep_coeff</A> (Cs_opt2, s11, s12, s22, s33, s13, s23, delta, jt, jtt)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_compute_interpolag_weight">compute_interpolag_weight</A> (iaddx, jaddy, kaddz, comp_x, comp_y, comp_z)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_compute_interpolag_coeff">compute_interpolag_coeff</A> (F, iaddx, jaddy, kaddz, comp_x, comp_y, comp_z)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_compute_dynamic_mum">compute_dynamic_mum</A> (AB, BB, S_ft, u_ft, v_ft, w_ft, S, S11, S12, S22, S33, S13, S23, tf_2, delta, G)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_update_interpolag_coeff">update_interpolag_coeff</A> (F_AB, F_BB, AB, BB, powcoeff, delta)
    private subroutine <A HREF="compute_lagscaledep.html#subroutine_compute_dynamic_coeff">compute_dynamic_coeff</A> (Cs_, Beta_, F_AB, F_BB, F_CD, F_DD)

end module compute_LagScaleDep
</PRE>
  module: compute Lagrangian Scale Dependent dynamic model
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>

<HR><H2> Description of Variables </H2>
<A NAME="var_dcp"><H3>dcp</H3></A>
<PRE>type (DECOMP_INFO), private, save :: dcp
</PRE>
<A NAME="var_tf1"><H3>tf1</H3></A>
<PRE>real (kind=rprec), private, parameter :: tf1 = 2._rprec
</PRE>
<A NAME="var_tf1_2"><H3>tf1_2</H3></A>
<PRE>real (kind=rprec), private, parameter :: tf1_2 = 4._rprec
</PRE>
<A NAME="var_tf2"><H3>tf2</H3></A>
<PRE>real (kind=rprec), private, parameter :: tf2 = 4._rprec
</PRE>
<A NAME="var_tf2_2"><H3>tf2_2</H3></A>
<PRE>real (kind=rprec), private, parameter :: tf2_2 = 16._rprec
</PRE>
<A NAME="var_opftime"><H3>opftime</H3></A>
<PRE>real (kind=rprec), private, parameter :: opftime = 1.5_rprec
</PRE>
<A NAME="var_f_coeff_init"><H3>F_coeff_init</H3></A>
<PRE>logical, private :: F_coeff_init = .false.
</PRE>
<A NAME="var_f_lm"><H3>F_LM</H3></A>
<PRE>real (kind=rprec), public, allocatable, dimension(:,:,:) :: F_LM
</PRE>
<A NAME="var_f_mm"><H3>F_MM</H3></A>
<PRE>real (kind=rprec), public, allocatable, dimension(:,:,:) :: F_MM
</PRE>
<A NAME="var_f_qn"><H3>F_QN</H3></A>
<PRE>real (kind=rprec), public, allocatable, dimension(:,:,:) :: F_QN
</PRE>
<A NAME="var_f_nn"><H3>F_NN</H3></A>
<PRE>real (kind=rprec), public, allocatable, dimension(:,:,:) :: F_NN
</PRE>
<A NAME="var_beta_mum"><H3>Beta_mum</H3></A>
<PRE>real (kind=rprec), public, allocatable, dimension(:,:,:) :: Beta_mum
</PRE>
<A NAME="var_u_lag"><H3>u_lag</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: u_lag
</PRE>
<A NAME="var_v_lag"><H3>v_lag</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: v_lag
</PRE>
<A NAME="var_w_lag"><H3>w_lag</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: w_lag
</PRE>
<A NAME="var_s"><H3>S</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: S
</PRE>
<A NAME="var_s_bar"><H3>S_bar</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: S_bar
</PRE>
<A NAME="var_s_hat"><H3>S_hat</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: S_hat
</PRE>
<A NAME="var_u_bar"><H3>u_bar</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: u_bar
</PRE>
<A NAME="var_v_bar"><H3>v_bar</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: v_bar
</PRE>
<A NAME="var_w_bar"><H3>w_bar</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: w_bar
</PRE>
<A NAME="var_u_hat"><H3>u_hat</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: u_hat
</PRE>
<A NAME="var_v_hat"><H3>v_hat</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: v_hat
</PRE>
<A NAME="var_w_hat"><H3>w_hat</H3></A>
<PRE>real (kind=rprec), private, dimension(:,:,:), allocatable :: w_hat
</PRE>
<A NAME="var_n_dmp"><H3>n_dmp</H3></A>
<PRE>real (kind=rprec), private, parameter :: n_dmp = 2._rprec
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_lagscaledep_init"><H3>LagScaleDep_init</H3></A>
<PRE>public subroutine LagScaleDep_init (dcp_main)
    type (DECOMP_INFO), intent(in) :: dcp_main
    ! Calls: decomp_2d_abort
end subroutine LagScaleDep_init
</PRE>
 subroutine: initialise sgs module
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
<A NAME="subroutine_lagscaledep_finalize"><H3>LagScaleDep_finalize</H3></A>
<PRE>private subroutine LagScaleDep_finalize ()
end subroutine LagScaleDep_finalize
</PRE>
 subroutine:
<A NAME="subroutine_compute_lagscaledep_coeff"><H3>compute_LagScaleDep_coeff</H3></A>
<PRE>public subroutine compute_LagScaleDep_coeff (Cs_opt2, s11, s12, s22, s33, s13, s23, delta, jt, jtt)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: Cs_opt2
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s11
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s12
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s22
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s33
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s13
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: s23
    real (kind=rprec), intent(IN) :: delta
    integer, intent(IN) :: jt
    integer, intent(IN) :: jtt
    ! Calls: compute_dynamic_coeff, compute_dynamic_mum, compute_interpolag_coeff, compute_interpolag_weight, update_interpolag_coeff
end subroutine compute_LagScaleDep_coeff
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
<A NAME="subroutine_compute_interpolag_weight"><H3>compute_interpolag_weight</H3></A>
<PRE>private subroutine compute_interpolag_weight (iaddx, jaddy, kaddz, comp_x, comp_y, comp_z)
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: iaddx
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: jaddy
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: kaddz
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: comp_x
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: comp_y
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: comp_z
end subroutine compute_interpolag_weight
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
<A NAME="subroutine_compute_interpolag_coeff"><H3>compute_interpolag_coeff</H3></A>
<PRE>private subroutine compute_interpolag_coeff (F, iaddx, jaddy, kaddz, comp_x, comp_y, comp_z)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(INOUT) :: F
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: iaddx
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: jaddy
    integer, dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: kaddz
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: comp_x
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: comp_y
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: comp_z
    ! Calls: update_halo3
end subroutine compute_interpolag_coeff
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
    The interpolation works in such a way that takes the values of the F_** function
    around the actual point (i,j,k), and multiplies it with a weight function. This weight function
    is the result of integrating over a streamline considering Taylor's Hypothesis. (Depending on how
    far is your previous function value, the weight is bigger or smaller. The weight is based in spatial
    distance).
 </UL>
<A NAME="subroutine_compute_dynamic_mum"><H3>compute_dynamic_mum</H3></A>
<PRE>private subroutine compute_dynamic_mum (AB, BB, S_ft, u_ft, v_ft, w_ft, S, S11, S12, S22, S33, S13, S23, tf_2, delta, G)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: AB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: BB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: S_ft
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: u_ft
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: v_ft
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: w_ft
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S11
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S12
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S22
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S33
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S13
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: S23
    real (kind=rprec), intent(IN) :: tf_2
    real (kind=rprec), intent(IN) :: delta
    real (kind=rprec), dimension(:,:), intent(IN) :: G
    ! Calls: test_filter
end subroutine compute_dynamic_mum
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
<A NAME="subroutine_update_interpolag_coeff"><H3>update_interpolag_coeff</H3></A>
<PRE>private subroutine update_interpolag_coeff (F_AB, F_BB, AB, BB, powcoeff, delta)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(INOUT) :: F_AB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(INOUT) :: F_BB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: AB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: BB
    real (kind=rprec), intent(IN) :: powcoeff
    real (kind=rprec), intent(IN) :: delta
end subroutine update_interpolag_coeff
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
<A NAME="subroutine_compute_dynamic_coeff"><H3>compute_dynamic_coeff</H3></A>
<PRE>private subroutine compute_dynamic_coeff (Cs_, Beta_, F_AB, F_BB, F_CD, F_DD)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: Cs_
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(OUT) :: Beta_
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: F_AB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: F_BB
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: F_CD
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),dcp%xsz(3)+1), intent(IN) :: F_DD
end subroutine compute_dynamic_coeff
</PRE>
 subroutine:
<P>
 <UL>
 <LI>  fabien margairaz (fabien.margairaz@gmail.com)
<P>
 <LI>  description:
 </UL>
</HTML>
