<HTML>
<HEAD>
   <TITLE> module compute_convective_padd (generated by f90doc) </TITLE>
</HEAD>
<H1> Module compute_convective_padd </H1>
<PRE>module compute_convective_padd

        ! Uses
    use <A HREF="parameters_io.html">parameters_IO</A>
    use <A HREF="fft_engine.html">fft_engine</A>
    use <A HREF="decomp_2d.html">decomp_2d</A>
    use <A HREF="decomp_2d_custom.html">decomp_2d_custom</A>
    use <A HREF="system_variables.html">system_variables</A>, only : u,v,w,dudy,dudz,dvdx,dvdz,dwdx,dwdy

        ! Variables
    type (DECOMP_INFO), private, save :: <A HREF="compute_convective_padd.html#var_dcp">dcp</A>
    type (DECOMP_INFO), private, save :: <A HREF="compute_convective_padd.html#var_dcpg">dcpg</A>
    type (DECOMP_INFO), private, save :: <A HREF="compute_convective_padd.html#var_dcp_big">dcp_big</A>
    type (DECOMP_INFO), private, save :: <A HREF="compute_convective_padd.html#var_dcp_hyb">dcp_hyb</A>
    real (kind=rprec), private, allocatable, dimension(:,:,:) :: <A HREF="compute_convective_padd.html#var_wk_hyb_x">wk_hyb_x</A>
    real (kind=rprec), private, allocatable, dimension(:,:,:) :: <A HREF="compute_convective_padd.html#var_wk_hyb_y">wk_hyb_y</A>
    real (kind=rprec), private, allocatable, dimension(:,:,:) :: <A HREF="compute_convective_padd.html#var_wk1_big">wk1_big</A>
    integer, private :: <A HREF="compute_convective_padd.html#var_ierr">ierr</A>

        ! Subroutines and functions
    public subroutine <A HREF="compute_convective_padd.html#subroutine_conv_init">conv_init</A> (dcp_main, dcp_ghost)
    public subroutine <A HREF="compute_convective_padd.html#subroutine_conv_finalize">conv_finalize</A> ()
    public subroutine <A HREF="compute_convective_padd.html#subroutine_compute_dealias_convec">compute_dealias_convec</A> (cx, cy, cz)
    private subroutine <A HREF="compute_convective_padd.html#subroutine_transpose_to_big">transpose_to_big</A> (cc_big, cc)
    private subroutine <A HREF="compute_convective_padd.html#subroutine_dealias">dealias</A> (cc, cc_big)

end module compute_convective_padd
</PRE>
 module: compute convective terms
<P>
 <UL>
 <LI>  last modified: fabien margairaz ( fabien.margairaz@gmail.com ), 09/06/2014
<P>
 <LI>  description:
  <UL>
  <LI>  use the 3/2 dealiasing rule
  <LI>  pencil decomposition: variables called _big are in the Y-pencil
  <LI>  vatiable size: _hyb are (3/2nx,ny,nz), _big are (3/2nx,3/2ny,nz)
 </UL>
  </UL>

<HR><H2> Description of Variables </H2>
<A NAME="var_dcp"><H3>dcp</H3></A>
<PRE>type (DECOMP_INFO), private, save :: dcp
</PRE>
<A NAME="var_dcpg"><H3>dcpg</H3></A>
<PRE>type (DECOMP_INFO), private, save :: dcpg
</PRE>
<A NAME="var_dcp_big"><H3>dcp_big</H3></A>
<PRE>type (DECOMP_INFO), private, save :: dcp_big
</PRE>
<A NAME="var_dcp_hyb"><H3>dcp_hyb</H3></A>
<PRE>type (DECOMP_INFO), private, save :: dcp_hyb
</PRE>
<A NAME="var_wk_hyb_x"><H3>wk_hyb_x</H3></A>
<PRE>real (kind=rprec), private, allocatable, dimension(:,:,:) :: wk_hyb_x
</PRE>
<A NAME="var_wk_hyb_y"><H3>wk_hyb_y</H3></A>
<PRE>real (kind=rprec), private, allocatable, dimension(:,:,:) :: wk_hyb_y
</PRE>
<A NAME="var_wk1_big"><H3>wk1_big</H3></A>
<PRE>real (kind=rprec), private, allocatable, dimension(:,:,:) :: wk1_big
</PRE>
<A NAME="var_ierr"><H3>ierr</H3></A>
<PRE>integer, private :: ierr
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_conv_init"><H3>conv_init</H3></A>
<PRE>public subroutine conv_init (dcp_main, dcp_ghost)
    type (DECOMP_INFO), intent(in) :: dcp_main
    type (DECOMP_INFO), intent(in) :: dcp_ghost
    ! Calls: decomp_2d_abort, decomp_info_init
end subroutine conv_init
</PRE>
 subroutine: initiate convective module
<P>
 <UL>
 <LI>  last modified: fabien margairaz ( fabien.margairaz@gmail.com ), 09/06/2014
<P>
 <LI>  description:
  <UL>
  <LI>  need dcp_info for 3/2 rule (to allocate 2Decomp workspace)
 </UL>
  </UL>
<A NAME="subroutine_conv_finalize"><H3>conv_finalize</H3></A>
<PRE>public subroutine conv_finalize ()
    ! Calls: decomp_info_finalize
end subroutine conv_finalize
</PRE>
 subroutine: finilise convective module
<A NAME="subroutine_compute_dealias_convec"><H3>compute_dealias_convec</H3></A>
<PRE>public subroutine compute_dealias_convec (cx, cy, cz)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),0:dcp%xsz(3)+1), intent(inout) :: cx
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),0:dcp%xsz(3)+1), intent(inout) :: cy
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),0:dcp%xsz(3)+1), intent(inout) :: cz
    ! Calls: dealias, transpose_to_big, update_ghost
end subroutine compute_dealias_convec
</PRE>
 subroutine: compute aliased convective terms
<P>
 <UL>
 <LI>  last modified: fabien margairaz ( fabien.margairaz@gmail.com ), 09/06/2014
<P>
 <LI>  description:
  <UL>
  <LI>  this routine uses ghost cell to impose BC on u and v at the bottom
 </UL>
  </UL>
<A NAME="subroutine_transpose_to_big"><H3>transpose_to_big</H3></A>
<PRE>private subroutine transpose_to_big (cc_big, cc)
    real (kind=rprec), dimension(dcp_big%ysz(1),dcp_big%ysz(2),0:dcp_big%ysz(3)+1), intent(inout) :: cc_big
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),0:dcp%xsz(3)+1), intent(in) :: cc
    ! Calls: dfftw_execute_dft_c2r, dfftw_execute_dft_r2c, transpose_x_to_y
end subroutine transpose_to_big
</PRE>
 subroutine: transpose data to big Y-pencil
<P>
 <UL>
 <LI>  last modified: fabien margairaz ( fabien.margairaz@gmail.com ), 09/06/2014
<P>
 <LI>  description:
  <UL>
  <LI>  both cc and cc_big do need ghost cells support
 </UL>
  </UL>
<A NAME="subroutine_dealias"><H3>dealias</H3></A>
<PRE>private subroutine dealias (cc, cc_big)
    real (kind=rprec), dimension(dcp%xsz(1),dcp%xsz(2),0:dcp%xsz(3)+1), intent(out) :: cc
    real (kind=rprec), dimension(dcp_big%ysz(1),dcp_big%ysz(2),0:dcp_big%ysz(3)+1), intent(in) :: cc_big
    ! Calls: dfftw_execute_dft_c2r, dfftw_execute_dft_r2c, transpose_y_to_x
end subroutine dealias
</PRE>
 subroutine: dealiase the data
<P>
 <UL>
 <LI>  last modified: fabien margairaz ( fabien.margairaz@gmail.com ), 09/06/2014
<P>
 <LI>  description:
  <UL>
  <LI>  cc_big does not need ghost cells support
  <LI>  cc does need ghost cells support
 </UL>
  </UL>
</HTML>
